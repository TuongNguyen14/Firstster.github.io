{"ast":null,"code":"import { Post } from \"./library/api\";\nimport * as ultility from \"./library/ultility\";\nimport swal from 'sweetalert2';\nexport const GetUser = () => {\n  try {\n    var cookie = ultility.GetCookie(\"user\");\n    var session = ultility.GetSession(\"user\");\n\n    if (cookie) {\n      let decode = ultility.DecodeURI(cookie);\n      let user = JSON.parse(decode);\n      return user;\n    } else if (session) {\n      let decode = ultility.DecodeURI(session);\n      let user = JSON.parse(decode);\n      return user;\n    } else return null;\n  } catch (e) {}\n};\n_c = GetUser;\nexport const Authenticate = (data, savecookie) => {\n  var json = JSON.stringify(data);\n  var encode = ultility.EncodeURI(json);\n  if (savecookie && Boolean(savecookie)) ultility.SetCookie(\"user\", encode, 30);else ultility.SetSession(\"user\", encode);\n  return true;\n};\n_c2 = Authenticate;\nexport const Login = async (credentials, savecookie) => {\n  try {\n    const response = await Post(\"/authenticate/\", credentials);\n\n    if (response && response.type === 1) {\n      Authenticate(response.data, savecookie);\n      ultility.DeleteCookie(\"uname\");\n      window.location.href = '/';\n    } else swal.fire({\n      type: \"error\",\n      html: response.message\n    });\n  } catch (e) {\n    throw e;\n  }\n};\n_c3 = Login;\nexport const Logout = async () => {\n  await Post(\"/Logout/\", null);\n  var user = await GetUser();\n  ultility.SetCookie(\"uname\", ultility.EncodeURI(user.username));\n  var cookie = ultility.GetCookie(\"user\");\n  var session = ultility.GetSession(\"user\");\n  console.log(session);\n  if (cookie) ultility.DeleteCookie(\"user\");\n  if (session) ultility.DeleteSession(\"user\");\n  window.location.href = '/Login';\n};\n_c4 = Logout;\nexport const CheckAuthentication = async () => {\n  var user = GetUser();\n  if (user) return user;else {\n    const response = await Post(\"/authenticate/\", null);\n\n    if (response && response.type === 1) {\n      user = response.data;\n      Authenticate(user, false);\n      ultility.DeleteCookie(\"uname\");\n      window.location.href = '/';\n      return user;\n    }\n  }\n  return null;\n};\n_c5 = CheckAuthentication;\n\nvar _c, _c2, _c3, _c4, _c5;\n\n$RefreshReg$(_c, \"GetUser\");\n$RefreshReg$(_c2, \"Authenticate\");\n$RefreshReg$(_c3, \"Login\");\n$RefreshReg$(_c4, \"Logout\");\n$RefreshReg$(_c5, \"CheckAuthentication\");","map":{"version":3,"sources":["C:/Users/Tuong/Desktop/React/frontend/src/security.js"],"names":["Post","ultility","swal","GetUser","cookie","GetCookie","session","GetSession","decode","DecodeURI","user","JSON","parse","e","Authenticate","data","savecookie","json","stringify","encode","EncodeURI","Boolean","SetCookie","SetSession","Login","credentials","response","type","DeleteCookie","window","location","href","fire","html","message","Logout","username","console","log","DeleteSession","CheckAuthentication"],"mappings":"AAAA,SAASA,IAAT,QAAqB,eAArB;AACA,OAAO,KAAKC,QAAZ,MAA0B,oBAA1B;AACA,OAAOC,IAAP,MAAiB,aAAjB;AAEA,OAAO,MAAMC,OAAO,GAAG,MAAM;AACzB,MAAI;AACA,QAAIC,MAAM,GAAGH,QAAQ,CAACI,SAAT,CAAmB,MAAnB,CAAb;AACA,QAAIC,OAAO,GAAGL,QAAQ,CAACM,UAAT,CAAoB,MAApB,CAAd;;AACA,QAAIH,MAAJ,EAAY;AACR,UAAII,MAAM,GAAGP,QAAQ,CAACQ,SAAT,CAAmBL,MAAnB,CAAb;AACA,UAAIM,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWJ,MAAX,CAAX;AACA,aAAOE,IAAP;AACH,KAJD,MAIO,IAAIJ,OAAJ,EAAa;AAChB,UAAIE,MAAM,GAAGP,QAAQ,CAACQ,SAAT,CAAmBH,OAAnB,CAAb;AACA,UAAII,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWJ,MAAX,CAAX;AACA,aAAOE,IAAP;AACH,KAJM,MAKF,OAAO,IAAP;AACR,GAbD,CAaE,OAAOG,CAAP,EAAU,CAEX;AACJ,CAjBM;KAAMV,O;AAmBb,OAAO,MAAMW,YAAY,GAAG,CAACC,IAAD,EAAOC,UAAP,KAAsB;AAC9C,MAAIC,IAAI,GAAGN,IAAI,CAACO,SAAL,CAAeH,IAAf,CAAX;AACA,MAAII,MAAM,GAAGlB,QAAQ,CAACmB,SAAT,CAAmBH,IAAnB,CAAb;AACA,MAAID,UAAU,IAAIK,OAAO,CAACL,UAAD,CAAzB,EAAuCf,QAAQ,CAACqB,SAAT,CAAmB,MAAnB,EAA2BH,MAA3B,EAAmC,EAAnC,EAAvC,KACKlB,QAAQ,CAACsB,UAAT,CAAoB,MAApB,EAA4BJ,MAA5B;AACL,SAAO,IAAP;AACH,CANM;MAAML,Y;AAQb,OAAO,MAAMU,KAAK,GAAG,OAAOC,WAAP,EAAoBT,UAApB,KAAmC;AACpD,MAAI;AACA,UAAMU,QAAQ,GAAG,MAAM1B,IAAI,CAAC,gBAAD,EAAmByB,WAAnB,CAA3B;;AACA,QAAIC,QAAQ,IAAIA,QAAQ,CAACC,IAAT,KAAkB,CAAlC,EAAqC;AACjCb,MAAAA,YAAY,CAACY,QAAQ,CAACX,IAAV,EAAgBC,UAAhB,CAAZ;AACAf,MAAAA,QAAQ,CAAC2B,YAAT,CAAsB,OAAtB;AACAC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,GAAvB;AACH,KAJD,MAKK7B,IAAI,CAAC8B,IAAL,CAAU;AACXL,MAAAA,IAAI,EAAE,OADK;AAEXM,MAAAA,IAAI,EAAEP,QAAQ,CAACQ;AAFJ,KAAV;AAIR,GAXD,CAYA,OAAOrB,CAAP,EAAU;AACN,UAAMA,CAAN;AACH;AACJ,CAhBM;MAAMW,K;AAkBb,OAAO,MAAMW,MAAM,GAAG,YAAY;AAC9B,QAAMnC,IAAI,CAAC,UAAD,EAAa,IAAb,CAAV;AACA,MAAIU,IAAI,GAAG,MAAMP,OAAO,EAAxB;AACAF,EAAAA,QAAQ,CAACqB,SAAT,CAAmB,OAAnB,EAA4BrB,QAAQ,CAACmB,SAAT,CAAmBV,IAAI,CAAC0B,QAAxB,CAA5B;AACA,MAAIhC,MAAM,GAAGH,QAAQ,CAACI,SAAT,CAAmB,MAAnB,CAAb;AACA,MAAIC,OAAO,GAAGL,QAAQ,CAACM,UAAT,CAAoB,MAApB,CAAd;AACA8B,EAAAA,OAAO,CAACC,GAAR,CAAYhC,OAAZ;AACA,MAAIF,MAAJ,EAAYH,QAAQ,CAAC2B,YAAT,CAAsB,MAAtB;AAA+B,MAAItB,OAAJ,EAAaL,QAAQ,CAACsC,aAAT,CAAuB,MAAvB;AACxDV,EAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,QAAvB;AACH,CATM;MAAMI,M;AAWb,OAAO,MAAMK,mBAAmB,GAAG,YAAY;AAC3C,MAAI9B,IAAI,GAAGP,OAAO,EAAlB;AACA,MAAIO,IAAJ,EAAU,OAAOA,IAAP,CAAV,KACK;AACD,UAAMgB,QAAQ,GAAG,MAAM1B,IAAI,CAAC,gBAAD,EAAmB,IAAnB,CAA3B;;AACA,QAAI0B,QAAQ,IAAIA,QAAQ,CAACC,IAAT,KAAkB,CAAlC,EAAqC;AACjCjB,MAAAA,IAAI,GAAGgB,QAAQ,CAACX,IAAhB;AACAD,MAAAA,YAAY,CAACJ,IAAD,EAAO,KAAP,CAAZ;AACAT,MAAAA,QAAQ,CAAC2B,YAAT,CAAsB,OAAtB;AACAC,MAAAA,MAAM,CAACC,QAAP,CAAgBC,IAAhB,GAAuB,GAAvB;AACA,aAAOrB,IAAP;AACH;AACJ;AACD,SAAO,IAAP;AACH,CAdM;MAAM8B,mB","sourcesContent":["import { Post } from \"./library/api\";\r\nimport * as ultility from \"./library/ultility\";\r\nimport swal from 'sweetalert2'\r\n\r\nexport const GetUser = () => {\r\n    try {\r\n        var cookie = ultility.GetCookie(\"user\");\r\n        var session = ultility.GetSession(\"user\");\r\n        if (cookie) {\r\n            let decode = ultility.DecodeURI(cookie);\r\n            let user = JSON.parse(decode);\r\n            return user;\r\n        } else if (session) {\r\n            let decode = ultility.DecodeURI(session);\r\n            let user = JSON.parse(decode);\r\n            return user;\r\n        }\r\n        else return null;\r\n    } catch (e) {\r\n\r\n    }\r\n};\r\n\r\nexport const Authenticate = (data, savecookie) => {\r\n    var json = JSON.stringify(data);\r\n    var encode = ultility.EncodeURI(json);\r\n    if (savecookie && Boolean(savecookie)) ultility.SetCookie(\"user\", encode, 30);\r\n    else ultility.SetSession(\"user\", encode)\r\n    return true;\r\n}\r\n\r\nexport const Login = async (credentials, savecookie) => {\r\n    try {\r\n        const response = await Post(\"/authenticate/\", credentials)\r\n        if (response && response.type === 1) {\r\n            Authenticate(response.data, savecookie);\r\n            ultility.DeleteCookie(\"uname\");\r\n            window.location.href = '/'\r\n        }\r\n        else swal.fire({\r\n            type: \"error\",\r\n            html: response.message\r\n        })\r\n    }\r\n    catch (e) {\r\n        throw e;\r\n    }\r\n}\r\n\r\nexport const Logout = async () => {\r\n    await Post(\"/Logout/\", null);\r\n    var user = await GetUser();\r\n    ultility.SetCookie(\"uname\", ultility.EncodeURI(user.username));\r\n    var cookie = ultility.GetCookie(\"user\");\r\n    var session = ultility.GetSession(\"user\");\r\n    console.log(session)\r\n    if (cookie) ultility.DeleteCookie(\"user\"); if (session) ultility.DeleteSession(\"user\");\r\n    window.location.href = '/Login'\r\n}\r\n\r\nexport const CheckAuthentication = async () => {\r\n    var user = GetUser();\r\n    if (user) return user;\r\n    else {\r\n        const response = await Post(\"/authenticate/\", null);\r\n        if (response && response.type === 1) {\r\n            user = response.data;\r\n            Authenticate(user, false);\r\n            ultility.DeleteCookie(\"uname\");\r\n            window.location.href = '/';\r\n            return user;\r\n        }\r\n    }\r\n    return null;\r\n}"]},"metadata":{},"sourceType":"module"}